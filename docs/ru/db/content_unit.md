## ContentUnit

### Таблица

|Колонка|Тип|Описание|
|--|--|--|
|`id`|Integer, Auto increment|ID контента, задаётся автоматически|
|`file_id`|Integer, ссылка|ID основного файла, привязанного к ContentUnit. Может быть NULL, если файл не требуется и всё содержимое находится в БД.|
|`linked_files`|Text|Привязанные к сущности файлы, перечисленные через запятую. Могут быть использованы в `internal_content`|
|`hash`|Text|Случайный хэш сущности. Не используется/рудимент|
|`display_name`|Text|Имя ContentUnit, которое будет отображаться в списках. Оно изменяемое|
|`description`|Text|Описание ContentUnit|
|`source`|Text|Откуда было получено ContentUnit: задаётся в формате [короткое имя]:[ссылка]. В сериализованном объекте разбирается на JSON (создаётся экстрактором)|
|`indexation_content_string`|Text|Текст, в котором будет проводится поиск. Его содержимое берётся из `internal_content`: вырезаются все ключи, оставляются только строки. Затем убираются пробелы и происходит соединение в одну строку|
|`frontend_data`|JSON (Text)|Информация, которая будет использоваться на фронтенде|
|`extractor_name`|Text|С помощью какого экстрактора была создана ContentUnit|
|`tags`|Text|Дополнительное поле, в котором будет проводиться поиск|
|`preview`|JSON (Text)|JSON объект со словарём, содержащий превью: ключ "photo" с массивом, внутри которого объекты с размером и названием файла|
|`internal_content`|JSON (Text)|Внутренний контент ContentUnit. Обычно — результат работы API|
|`unlisted`|Integer (Bool)|Будет ли показываться сущность в общем списке|
|`author`|Text|Автор сущности. Обычно задаётся имя компьютера с именем пользователя.|

### Класс

#### file (getter)

Возвращает привязанный файл (если он имеется) в виде класса.

#### getFormattedInfo(recursive=,recurse_level=)

Возвращает форматированный `internal_content`. 

`recursive` — будут ли заменятся строки вида "__$|ContentUnit_{x}" на информацию другой сущности из linked_files.

`recurse_level` — каков предел уровня замены (по умолчанию 3)

#### getLinkedEntities()

Возвращает привязанные ContentUnit в виде массива.

#### getApiStructure()

Возвращает метаинформацию об ContentUnit.

#### fromJson()

#### fetchItems()

### Привязанные ContentUnit

В колонке `linked_files` указываются присоединённые модели в формате:

```
file_2,ContentUnit_8
```

Они могут быть использованы в json `internal_content`. Для подстановки структуры другой модели на выводе нужно заменить значение на `__$|ContentUnit_{id}` или  `__$|file_{id}`. Не рекомендую заменять оригинальный контент таким ключом; лучше создать дополнительный.
